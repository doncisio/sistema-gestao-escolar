2026-02-18 09:39:15,623 level=INFO name=__main__ message=======================================================================
2026-02-18 09:39:15,623 level=INFO name=__main__ message=Sistema de Gest√£o Escolar v2.0.0
2026-02-18 09:39:15,624 level=INFO name=__main__ message=======================================================================
2026-02-18 09:39:15,624 level=INFO name=__main__ message=Ambiente: PRODU√á√ÉO
2026-02-18 09:39:15,624 level=INFO name=__main__ message=Banco: localhost/redeescola
2026-02-18 09:39:15,624 level=INFO name=__main__ message=Escola ID: 60
2026-02-18 09:39:15,624 level=INFO name=__main__ message=Backup autom√°tico: HABILITADO
2026-02-18 09:39:15,625 level=INFO name=__main__ message=Log Level: INFO
2026-02-18 09:39:15,625 level=INFO name=__main__ message=Log Format: text
2026-02-18 09:39:15,625 level=INFO name=__main__ message=======================================================================
2026-02-18 09:39:16,432 level=INFO name=db.connection message=‚úì Conex√£o testada com sucesso
2026-02-18 09:39:16,464 level=INFO name=db.connection message=‚úì Connection Pool inicializado: gestao_escolar_pool (size=5)
2026-02-18 09:39:17,135 level=INFO name=src.ui.app message=Sistema inicializado com sucesso
2026-02-18 09:39:17,172 level=INFO name=src.core.seguranca message=Sistema de Backup Autom√°tico ativado (14:05 e 17:00)
2026-02-18 09:39:17,173 level=INFO name=src.core.seguranca message=‚úì Sistema de backup autom√°tico iniciado com sucesso
2026-02-18 09:39:17,173 level=INFO name=__main__ message=‚úÖ Sistema pronto - Iniciando interface
2026-02-18 09:39:19,519 level=INFO name=src.interfaces.horarios_escolares message=Iniciando InterfaceHorariosEscolares...
2026-02-18 09:39:19,519 level=INFO name=src.interfaces.horarios_escolares message=  root=None, janela_principal=.
2026-02-18 09:39:19,519 level=INFO name=src.interfaces.horarios_escolares message=  Estado janela principal: normal
2026-02-18 09:39:19,520 level=INFO name=src.interfaces.horarios_escolares message=  Vis√≠vel janela principal: 1
2026-02-18 09:39:19,520 level=INFO name=src.interfaces.horarios_escolares message=Criando nova janela Toplevel...
2026-02-18 09:39:19,521 level=INFO name=src.interfaces.horarios_escolares message=N√≠veis de ensino dispon√≠veis:
2026-02-18 09:39:19,522 level=INFO name=src.interfaces.horarios_escolares message=  ID: 1, Nome: Ensino Infantil
2026-02-18 09:39:19,522 level=INFO name=src.interfaces.horarios_escolares message=  ID: 2, Nome: Ensino Fundamental I
2026-02-18 09:39:19,522 level=INFO name=src.interfaces.horarios_escolares message=  ID: 3, Nome: Ensino Fundamental II
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=
Todas as s√©ries dispon√≠veis:
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=  ID: 1, Nome: Infantil 1, N√≠vel ID: 1
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=  ID: 2, Nome: Infantil 2, N√≠vel ID: 1
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=  ID: 3, Nome: 1¬∫ Ano, N√≠vel ID: 2
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=  ID: 4, Nome: 2¬∫ Ano, N√≠vel ID: 2
2026-02-18 09:39:19,523 level=INFO name=src.interfaces.horarios_escolares message=  ID: 5, Nome: 3¬∫ Ano, N√≠vel ID: 2
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 6, Nome: 4¬∫ Ano, N√≠vel ID: 2
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 7, Nome: 5¬∫ Ano, N√≠vel ID: 2
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 8, Nome: 6¬∫ Ano, N√≠vel ID: 3
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 9, Nome: 7¬∫ Ano, N√≠vel ID: 3
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 10, Nome: 8¬∫ Ano, N√≠vel ID: 3
2026-02-18 09:39:19,524 level=INFO name=src.interfaces.horarios_escolares message=  ID: 11, Nome: 9¬∫ Ano, N√≠vel ID: 3
2026-02-18 09:39:19,525 level=INFO name=src.interfaces.horarios_escolares message=
S√©ries espec√≠ficas carregadas: 9
2026-02-18 09:39:19,525 level=INFO name=src.interfaces.horarios_escolares message=  ID: 3, Nome: 1¬∫ Ano
2026-02-18 09:39:19,525 level=INFO name=src.interfaces.horarios_escolares message=  ID: 4, Nome: 2¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 5, Nome: 3¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 6, Nome: 4¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 7, Nome: 5¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 8, Nome: 6¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 9, Nome: 7¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 10, Nome: 8¬∫ Ano
2026-02-18 09:39:19,526 level=INFO name=src.interfaces.horarios_escolares message=  ID: 11, Nome: 9¬∫ Ano
2026-02-18 09:39:19,528 level=INFO name=src.interfaces.horarios_escolares message=Professores carregados: 18
2026-02-18 09:39:19,529 level=INFO name=src.interfaces.horarios_escolares message=Disciplinas carregadas: 18
2026-02-18 09:39:19,530 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: Iniciando cria√ß√£o da interface...
2026-02-18 09:39:19,530 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: Frames criados
2026-02-18 09:39:19,532 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: Cabe√ßalho criado
2026-02-18 09:39:19,537 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: √Årea de sele√ß√£o criada
2026-02-18 09:39:19,542 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: Grade de hor√°rios criada
2026-02-18 09:39:19,597 level=INFO name=src.interfaces.horarios_escolares message=criar_interface: Barra de bot√µes criada
2026-02-18 09:39:19,710 level=INFO name=src.interfaces.horarios_escolares message=Ocultando janela principal...
2026-02-18 09:39:19,713 level=INFO name=src.interfaces.horarios_escolares message=‚úì Interface de hor√°rios escolares criada com sucesso
2026-02-18 09:39:19,714 level=INFO name=src.interfaces.horarios_escolares message=  Estado da janela: normal
2026-02-18 09:39:19,714 level=INFO name=src.interfaces.horarios_escolares message=  Geometria: 1200x700+26+26
2026-02-18 09:39:19,714 level=INFO name=src.interfaces.horarios_escolares message=  Vis√≠vel: 1
2026-02-18 09:39:19,715 level=INFO name=src.interfaces.horarios_escolares message=  Mapeada: 1
2026-02-18 09:39:19,715 level=INFO name=src.ui.action_callbacks message=Interface de hor√°rios escolares aberta
2026-02-18 09:39:22,148 level=INFO name=src.interfaces.horarios_escolares message=Turmas encontradas para s√©rie 3, turno MAT:
2026-02-18 09:39:22,148 level=INFO name=src.interfaces.horarios_escolares message=  ID: 28, Nome: '', Serie ID: 3
2026-02-18 09:39:22,149 level=INFO name=src.interfaces.horarios_escolares message=  ID: 38, Nome: '', Serie ID: 3# Guia de Contribui√ß√£o

Obrigado por considerar contribuir com o Sistema de Gest√£o Escolar! Este documento fornece diretrizes para garantir que o c√≥digo mantenha qualidade e consist√™ncia.

## üìã Sum√°rio

- [C√≥digo de Conduta](#c√≥digo-de-conduta)
- [Como Contribuir](#como-contribuir)
- [Padr√µes de C√≥digo](#padr√µes-de-c√≥digo)
- [Estrutura do Projeto](#estrutura-do-projeto)
- [Commits e Pull Requests](#commits-e-pull-requests)
- [Testes](#testes)
- [Documenta√ß√£o](#documenta√ß√£o)

---

## C√≥digo de Conduta

Este projeto segue princ√≠pios de colabora√ß√£o respeitosa. Esperamos que todos os contribuidores:
- Sejam respeitosos e inclusivos
- Aceitem cr√≠ticas construtivas
- Mantenham foco no que √© melhor para a comunidade
- Demonstrem empatia com outros membros

## Como Contribuir

### 1. Escolha uma Issue

- Verifique as [issues abertas](https://github.com/seu-usuario/gestao-escolar/issues)
- Issues marcadas com `good first issue` s√£o ideais para iniciantes
- Comente na issue para indicar que est√° trabalhando nela

### 2. Fork e Clone

```bash
# Fork o reposit√≥rio no GitHub, depois:
git clone https://github.com/seu-usuario/gestao-escolar.git
cd gestao-escolar
```

### 3. Crie uma Branch

```bash
git checkout -b feature/minha-funcionalidade
# ou
git checkout -b fix/correcao-de-bug
```

**Conven√ß√£o de nomes de branches:**
- `feature/` - novas funcionalidades
- `fix/` - corre√ß√µes de bugs
- `refactor/` - refatora√ß√µes de c√≥digo
- `docs/` - mudan√ßas em documenta√ß√£o
- `test/` - adi√ß√£o ou corre√ß√£o de testes

### 4. Configure o Ambiente

```bash
# Criar virtualenv
python -m venv venv
venv\Scripts\activate  # Windows
# ou
source venv/bin/activate  # Linux/Mac

# Instalar depend√™ncias
pip install -r requirements.txt

# Configurar .env
copy .env.example .env
# Editar .env com suas configura√ß√µes
```

### 5. Fa√ßa suas Mudan√ßas

Siga os [Padr√µes de C√≥digo](#padr√µes-de-c√≥digo) abaixo.

### 6. Teste suas Mudan√ßas

```bash
# Executar todos os testes
pytest tests/

# Executar testes com cobertura
pytest tests/ --cov=src --cov-report=html

# Executar apenas testes unit√°rios (r√°pidos)
pytest tests/unit/

# Executar testes de integra√ß√£o
pytest tests/integration/ -m integration
```

### 7. Commit e Push

```bash
git add .
git commit -m "feat: adiciona relat√≥rio de desempenho comparativo"
git push origin feature/minha-funcionalidade
```

### 8. Abra um Pull Request

- No GitHub, abra um PR da sua branch para `main`
- Preencha o template do PR com detalhes
- Aguarde review e responda aos coment√°rios

---

## Padr√µes de C√≥digo

### Python Style Guide

Seguimos a [PEP 8](https://pep8.org/) com algumas adapta√ß√µes:

#### Imports

```python
# 1. Imports da biblioteca padr√£o
import os
import sys
from datetime import datetime

# 2. Imports de terceiros
import mysql.connector
from tkinter import Tk, Frame

# 3. Imports do projeto
from src.core.config_logs import get_logger
from src.services.aluno_service import buscar_aluno_por_id
from db.connection import get_cursor

# Ordem alfab√©tica dentro de cada grupo
# Use imports absolutos (src.* ao inv√©s de relativos)
```

#### Naming Conventions

```python
# Classes: PascalCase
class AlunoService:
    pass

# Fun√ß√µes e vari√°veis: snake_case
def buscar_aluno_por_id(aluno_id: int) -> dict:
    total_alunos = 0
    nome_completo = "Jo√£o Silva"

# Constantes: UPPER_SNAKE_CASE
ESCOLA_ID = 60
ANO_LETIVO_ATUAL = 2026

# Privadas: prefixo _
def _validar_cpf(cpf: str) -> bool:
    pass
```

#### Type Hints

Sempre use type hints em fun√ß√µes p√∫blicas:

```python
from typing import Optional, List, Dict, Any

def buscar_alunos(
    escola_id: int,
    status: str = "Ativo",
    limite: Optional[int] = None
) -> List[Dict[str, Any]]:
    """
    Busca alunos com filtros.
    
    Args:
        escola_id: ID da escola
        status: Status da matr√≠cula (padr√£o: "Ativo")
        limite: N√∫mero m√°ximo de resultados
        
    Returns:
        Lista de dicts com dados dos alunos
    """
    pass
```

#### Docstrings

Use Google Style para docstrings:

```python
def calcular_media_final(notas: List[float], pesos: List[float]) -> float:
    """Calcula m√©dia ponderada das notas.
    
    Args:
        notas: Lista de notas num√©ricas
        pesos: Lista de pesos de cada nota
        
    Returns:
        M√©dia ponderada final
        
    Raises:
        ValueError: Se notas e pesos tiverem tamanhos diferentes
    """
    if len(notas) != len(pesos):
        raise ValueError("Notas e pesos devem ter o mesmo tamanho")
    # ...
```

#### Error Handling

**‚ùå N√ÉO fa√ßa:**
```python
try:
    cursor.execute(query)
except:  # NUNCA use except nu
    pass
```

**‚úÖ FA√áA:**
```python
try:
    cursor.execute(query)
except mysql.connector.Error as e:
    logger.error(f"Erro ao executar query: {e}")
    raise
except Exception as e:
    logger.exception(f"Erro inesperado: {e}")
    raise
```

#### Logging

```python
from src.core.config_logs import get_logger
logger = get_logger(__name__)  # Sempre use __name__

# N√≠veis de log
logger.debug("Informa√ß√£o detalhada para debug")
logger.info("Opera√ß√£o bem-sucedida")
logger.warning("Algo inesperado, mas n√£o cr√≠tico")
logger.error("Erro recuper√°vel")
logger.exception("Erro com stack trace")
```

### Database Access

**‚ùå N√ÉO acesse o banco direto nas interfaces:**
```python
# ERRADO em src/interfaces/minha_interface.py
import mysql.connector
conn = mysql.connector.connect(...)
cursor = conn.cursor()
cursor.execute("SELECT * FROM alunos")
```

**‚úÖ Use services e get_cursor:**
```python
# CORRETO em src/interfaces/minha_interface.py
from src.services.aluno_service import buscar_alunos

alunos = buscar_alunos(escola_id=60, status="Ativo")

# CORRETO em src/services/aluno_service.py
from db.connection import get_cursor

def buscar_alunos(escola_id: int, status: str) -> List[Dict]:
    with get_cursor() as cursor:
        cursor.execute("""
            SELECT id, nome, data_nascimento
            FROM alunos
            WHERE escola_id = %s AND status = %s
        """, (escola_id, status))
        return cursor.fetchall()
```

### UI Patterns

```python
# Usar cores centralizadas
from src.ui.colors import AppColors
colors = App Colors()

# N√ÉO definir cores inline:
# co0 = '#fff' ‚ùå

# Janelas secund√°rias via callback
def abrir_cadastro_aluno():
    from src.interfaces.cadastro_aluno import InterfaceCadastroAluno
    app.janela.withdraw()  # Esconder janela pai
    janela = InterfaceCadastroAluno(app)
    # ... configurar janela ...
    janela.protocol("WM_DELETE_WINDOW", lambda: fechar_janela(janela, app))
```

---

## Estrutura do Projeto

```
gestao/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/           # Configura√ß√µes e logs
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/     # UIs Toplevel (janelas secund√°rias)
‚îÇ   ‚îú‚îÄ‚îÄ ui/             # UI principal (app, menu, dashboard, table)
‚îÇ   ‚îú‚îÄ‚îÄ services/       # L√≥gica de neg√≥cio (acessa DB)
‚îÇ   ‚îú‚îÄ‚îÄ models/         # Modelos Pydantic
‚îÇ   ‚îú‚îÄ‚îÄ relatorios/     # Gera√ß√£o de relat√≥rios PDF
‚îÇ   ‚îú‚îÄ‚îÄ importadores/   # Importa√ß√£o de dados externos
‚îÇ   ‚îú‚îÄ‚îÄ exportadores/   # Exporta√ß√£o de dados
‚îÇ   ‚îî‚îÄ‚îÄ utils/          # Utilit√°rios diversos
‚îú‚îÄ‚îÄ db/                 # Conex√£o e queries SQL
‚îú‚îÄ‚îÄ auth/               # Autentica√ß√£o e autoriza√ß√£o
‚îú‚îÄ‚îÄ banco_questoes/     # Sistema de quest√µes BNCC
‚îú‚îÄ‚îÄ tests/              # Testes automatizados
‚îî‚îÄ‚îÄ docs/               # Documenta√ß√£o
```

### Onde Colocar Cada Tipo de C√≥digo

| Tipo de C√≥digo | Pasta | Exemplo |
|----------------|-------|---------|
| SQL + l√≥gica de neg√≥cio | `src/services/` | `aluno_service.py` |
| Interface Tkinter | `src/interfaces/` para secund√°rias, `src/ui/` para principais | `cadastro_aluno.py` |
| Queries SQL puras | `db/queries.py` ou inline no service | |
| Modelos de dados | `src/models/` | `aluno.py` com Pydantic |
| Configura√ß√£o | `src/core/config/` | `settings.py` |
| Logs | Use `get_logger(__name__)` | |

---

## Commits e Pull Requests

### Conven√ß√£o de Commits

Seguimos [Conventional Commits](https://www.conventionalcommits.org/pt-br/):

```
<tipo>(<escopo>): <descri√ß√£o curta>

<descri√ß√£o detalhada opcional>

<footer opcional>
```

**Tipos:**
- `feat`: nova funcionalidade
- `fix`: corre√ß√£o de bug
- `refactor`: refatora√ß√£o de c√≥digo
- `docs`: mudan√ßas em documenta√ß√£o
- `test`: adi√ß√£o ou corre√ß√£o de testes
- `chore`: tarefas de build, configs, etc
- `perf`: melhorias de performance
- `style`: formata√ß√£o de c√≥digo (n√£o muda l√≥gica)

**Exemplos:**
```bash
git commit -m "feat(aluno): adiciona busca por CPF"
git commit -m "fix(dashboard): corrige movimento mensal mostrando 66 ao inv√©s de 295"
git commit -m "refactor(services): move report_service para package reports/"
git commit -m "docs: adiciona CONTRIBUTING.md"
git commit -m "test(aluno): adiciona testes para valida√ß√£o de CPF"
```

### Pull Request Guidelines

**Checklist antes de abrir PR:**
- [ ] C√≥digo segue os padr√µes acima
- [ ] Todos os testes passam (`pytest tests/`)
- [ ] Novos testes adicionados para novas funcionalidades
- [ ] Docstrings atualizadas
- [ ] CHANGELOG.md atualizado (se aplic√°vel)
- [ ] Sem `except:` nu ou valores hard-coded
- [ ] Type hints adicionados
- [ ] Commit messages seguem Conventional Commits

**Template de PR:**
```markdown
## Descri√ß√£o
Breve descri√ß√£o das mudan√ßas

## Tipo de Mudan√ßa
- [ ] Bug fix
- [ ] Nova funcionalidade
- [ ] Breaking change
- [ ] Documenta√ß√£o

## Como Testar
Passos para testar as mudan√ßas

## Checklist
- [ ] Testes passando
- [ ] Documenta√ß√£o atualizada
- [ ] CHANGELOG.md atualizado
```

---

## Testes

### Escrevendo Testes

```python
# tests/unit/test_aluno_service.py
import pytest
from unittest.mock import MagicMock, patch
from src.services.aluno_service import buscar_aluno_por_id

@pytest.fixture
def mock_cursor():
    cursor = MagicMock()
    cursor.fetchone.return_value = {
        'id': 1, 'nome': 'Jo√£o', 'cpf': '12345678900'
    }
    return cursor

def test_buscar_aluno_por_id_encontrado(mock_cursor):
    """Testa busca de aluno existente."""
    with patch('db.connection.get_cursor') as mock:
        mock.return_value.__enter__.return_value = mock_cursor
        
        aluno = buscar_aluno_por_id(1)
        
        assert aluno['id'] == 1
        assert aluno['nome'] == 'Jo√£o'
        mock_cursor.execute.assert_called_once()

def test_buscar_aluno_por_id_nao_encontrado(mock_cursor):
    """Testa busca de aluno inexistente."""
    mock_cursor.fetchone.return_value = None
    
    with patch('db.connection.get_cursor') as mock:
        mock.return_value.__enter__.return_value = mock_cursor
        
        aluno = buscar_aluno_por_id(999)
        
        assert aluno is None
```

### Executando Testes

```bash
# Todos os testes
pytest

# Com cobertura
pytest --cov=src --cov-report=html

# Apenas unit√°rios (r√°pidos)
pytest tests/unit/

# Apenas um arquivo
pytest tests/unit/test_aluno_service.py

# Apenas um teste
pytest tests/unit/test_aluno_service.py::test_buscar_aluno_por_id_encontrado

# Com output verboso
pytest -v

# Parar no primeiro erro
pytest -x
```

---

## Documenta√ß√£o

### Atualizando Documenta√ß√£o

Ao adicionar/modificar funcionalidades, atualize:

1. **Docstrings** no c√≥digo
2. **README.md** na raiz (se for funcionalidade vis√≠vel)
3. **docs/README.md** (documenta√ß√£o t√©cnica)
4. **CHANGELOG.md** (sempre!)
5. Guias espec√≠ficos em **docs/guias/** (se aplic√°vel)

### Diagrama ER

Ao alterar o schema do banco, atualize o arquivo `redeescola3.mwb` (MySQL Workbench) e exporte um PNG para `docs/`.

---

## Perguntas?

- Abra uma [issue](https://github.com/seu-usuario/gestao-escolar/issues) com a label `question`
- Entre em contato com os mantenedores

**Obrigado por contribuir! üéâ**
