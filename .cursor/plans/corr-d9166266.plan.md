<!-- d9166266-3e29-48f9-81ed-9c5e20ed665b f88e6ecb-988a-4107-923c-08c7a56d791c -->
# Correção: turmas impressas incorretas no PDF

## O problema

Ao montar o PDF, as turmas selecionadas são obtidas pelos índices da listbox, mas mapeadas contra `self.todas_turmas`. Quando a lista exibida é filtrada (ex.: ANOS INICIAIS), os índices não batem com a lista completa, resultando em turmas erradas (ex.: CRECHE).

## O que farei

1. Guardar a lista exibida

   - Em `InterfaceSolicitacaoProfessores.py`, no método `_carregar_turmas_especificas`, atribuir `self._turmas_exibidas = turmas` sempre que carregar opções na listbox.
   - Em `_carregar_todas_turmas`, repassar para `_carregar_turmas_especificas` (já faz) garantindo que `_turmas_exibidas` seja atualizada também no “todas”.

2. Usar a lista exibida ao montar o PDF

   - Em `_montar_elementos_pdf`, na coleta das turmas, trocar `self.todas_turmas[idx]` por `self._turmas_exibidas[idx]` (fallback para `self.todas_turmas` se necessário).

3. Pequenas salvaguardas

   - Se a listbox estiver desabilitada (ex.: Coordenador), não exigir turmas e deixar o campo vazio no PDF.

## Arquivo impactado

- `InterfaceSolicitacaoProfessores.py`

## Trechos essenciais a alterar (referência)

- Definir `self._turmas_exibidas` quando carregar opções:
```318:322:InterfaceSolicitacaoProfessores.py
self.lista_turmas.delete(0, tk.END)
for turma in turmas:
    self.lista_turmas.insert(tk.END, turma)
# adicionar:
self._turmas_exibidas = list(turmas)
```

- Usar `self._turmas_exibidas` ao montar PDF:
```462:469:InterfaceSolicitacaoProfessores.py
indices = list(self.lista_turmas.curselection())
turmas_sel = []
base = getattr(self, '_turmas_exibidas', self.todas_turmas)
for idx in indices:
    turmas_sel.append(str(base[idx]))
```


## Resultado esperado

- Selecionando ANOS INICIAIS, o PDF mostrará exatamente as turmas escolhidas dessa lista (ex.: “1º ANO A, 2º ANO B”), sem trocar por itens de EDUCAÇÃO INFANTIL.

### To-dos

- [ ] Armazenar lista exibida em _turmas_exibidas ao carregar turmas
- [ ] Usar _turmas_exibidas para montar turmas no PDF
- [ ] Adicionar salvaguardas quando listbox desabilitada ou sem seleção